---
draw:
title: 显存
date created: 2025-03-11
date modified: 2025-03-11
---

通俗来说：

- **GPU 的显存（VRAM）**，类似于电脑的内存（RAM），但它是显卡上的专用内存，专门给**GPU**使用。
- CPU 的内存（RAM）用于处理一般数据和代码执行。
- **GPU 显存**则用于专门存放 GPU 运算需要的数据，比如模型参数、数据输入、输出结果、梯度信息等。

---

## 📌 为什么训练模型时显存经常不够用？

因为模型训练时需要把以下内容全部装进 GPU 显存中：

- **模型本身的参数**：模型越大，占用显存越多。
- **输入的数据**（如token化后的文本数据）。
- **中间结果与梯度信息**（用于反向传播和更新参数的计算）。
- **优化器信息**（如 Adam 优化器会额外存储一部分数据）。

当你的任务特别大（比如大模型、大批次数据）或打开了额外的优化选项（如 Liger、FlashAttention 等），都会导致 GPU 显存需求大幅增加，可能会超出 GPU 提供的显存容量，引发显存不足。

---

## 🚩 举个简单例子

|项目|占用的 GPU 显存（示例）|
|---|---|
|模型参数（Qwen 1.5B）|大约 3~5GB 左右|
|数据输入 (Batch)|大约 2~4GB 左右|
|梯度计算、中间结果|大约 4~8GB 左右|
|优化器状态|大约 2~4GB 左右|
|Liger 优化|额外的显存开销（1~3GB以上）|

当这些数据全部加载后，你的 GPU 显存（24GB）可能就不够用了。

---

## 🚩 因此

- 如果出现显存不足，就应当适当关闭一些占用显存的优化（如`use_liger`）。
- 或者减小单次训练的数据量（如减小 batch size）。

现在关闭`use_liger`即可有效降低显存占用。

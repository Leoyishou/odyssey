---
draw:
title: 行式存储和列式存储
tags: []
date created: 2024-06-05
date modified: 2024-11-12
---

excerpt

<!-- more -->

列式存储（Columnar Storage）和行式存储（Row Storage）是两种不同的数据存储方式。列式存储通常在某些场景下比行式存储更高效，特别是在数据分析和查询操作中。以下是列式存储通常比行式存储更高效的原因：

  

**1. 数据压缩效率**

  

- **列式存储**：由于同一列的数据类型相同，并且经常具有相似的值（如重复或范围较小的数值），列式存储的数据压缩效率通常较高。可以使用更高级的压缩算法，如 RLE（Run Length Encoding）、字典编码等。
- **行式存储**：行式存储每一行的数据类型可能不同，数据的相似性较低，压缩效率较差。

  

**2. 查询性能**

  

- **列式存储**：在进行聚合查询和分析查询时，通常只需要访问所需的列。例如，计算某列的平均值或求和时，只需读取该列的数据，大大减少了 I/O 操作。
- **行式存储**：查询时需要读取整个行的数据，即使只需要其中的几列，这会增加不必要的 I/O 开销。

  

**3. 内存使用效率**

  

- **列式存储**：因为只读取所需的列，内存使用更高效。可以加载更多的列数据到内存中，从而提高查询性能。
- **行式存储**：由于需要读取和处理整个行的数据，内存使用效率较低，尤其在只需要部分列的查询中。

  

**4. 矢量化处理**

  

- **列式存储**：列式存储适合矢量化处理，CPU 可以更有效地对列数据进行批量处理，利用现代 CPU 的指令集进行并行计算，提高处理速度。
- **行式存储**：行式存储在矢量化处理方面不如列式存储高效，因为每次处理时都要解码整行数据。

  

**5. 缓存命中率**

  

- **列式存储**：由于连续的同一列的数据存储在一起，可以更好地利用 CPU 缓存，提高缓存命中率，减少内存访问次数。
- **行式存储**：数据存储在一行中，不同列的数据存储位置不连续，缓存命中率较低。

  

**适用场景**

  

- **列式存储**：适用于数据分析、OLAP（Online Analytical Processing）系统、大规模数据仓库、需要频繁读取和聚合操作的场景。
- **行式存储**：适用于 OLTP（Online Transaction Processing）系统、事务处理系统、需要频繁插入、更新和删除操作的场景。

  

**总结**

  

列式存储通过提高数据压缩效率、减少 I/O 操作、优化内存使用、支持矢量化处理以及提高缓存命中率，在大规模数据分析和查询操作中比行式存储更加高效。

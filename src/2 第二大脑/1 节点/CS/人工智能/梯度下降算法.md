---
draw:
tags: []
title: 梯度下降算法
date created: 2024-09-20
date modified: 2025-01-24
---

好的，我将把之前的回答中 LaTeX 公式修改为更适合 Obsidian 的 Markdown 数学公式形式，并进行一些排版上的优化，使其在 Obsidian 中显示更清晰。

下面是修改后的回答：

下面我来详细解释一下为什么求偏导数是梯度下降优化的关键：

**1. 梯度下降的核心思想**

梯度下降是一种迭代优化算法，用于寻找函数的最小值。其核心思想是：沿着函数梯度（对于多变量函数，就是偏导数组成的向量）的反方向移动，函数值下降最快。就像一个下山的人，为了尽快到达山底，他会沿着坡度最陡的方向下山。

**2. 偏导数的意义**

- **方向：** 对于多变量函数，偏导数表示函数沿着某个坐标轴方向的变化率。梯度是由所有偏导数组成的向量，它指向函数值增长最快的方向。因此，梯度的反方向就是函数值下降最快的方向。
- **步长：** 偏导数的大小反映了函数在该方向上的变化速度。偏导数越大，函数在该方向上的变化越快，梯度下降时应该走的步长也应该相应地大一些；反之，偏导数越小，函数在该方向上的变化越慢，梯度下降时应该走的步长也应该相应地小一些。

**3. 梯度下降的步骤**

梯度下降的步骤如下：

1. **选择初始点：** 在函数曲面上随机选择一个起始点。
    
2. **计算梯度：** 计算函数在该点的梯度（所有偏导数）。
    
3. **更新参数：** 沿着梯度的反方向移动一定的步长，更新参数。更新公式为：

$$
    \theta_{\text{new}} = \theta_{\text{old}} - \eta \cdot \nabla J(\theta)
$$

其中：

- θ：表示需要优化的参数（例如 Word2Vec 中的词向量）。
- η：表示学习率，控制每次更新的步长。
- ∇J(θ)：表示损失函数 J 关于参数 θ 的梯度。

1. **重复步骤 2 和 3：** 不断重复计算梯度和更新参数，直到函数收敛到最小值或达到预定的迭代次数。
    

**4. 在 Word2Vec 中的应用**

在 Word2Vec 中，我们需要优化的参数是词向量。损失函数衡量了模型预测的上下文词的概率与真实上下文词的差距。通过计算损失函数关于词向量的偏导数，我们可以得到梯度，然后使用梯度下降算法来更新词向量，使得损失函数不断减小，模型的预测能力不断提高。

例如，在之前的推导中，我们得到了 `J<sub>naive-softmax</sub>` 关于 `v<sub>c</sub>` 的偏导数：

$$
\frac{\partial J_{\text{naive-softmax}}(v_c, o, U)}{\partial v_c} = (\hat{y} - y)^T U
$$

这个偏导数就告诉我们应该如何更新中心词向量 vc​：

$$
v_c^{\text{new}} = v_c^{\text{old}} - \eta \cdot (\hat{y} - y)^T U
$$

**总结**

求偏导数是梯度下降优化的核心步骤，它提供了梯度下降算法所需的**方向**和**步长**信息。通过不断地沿着梯度的反方向更新参数，我们可以使函数收敛到最小值，从而达到优化的目的。在 Word2Vec 中，求偏导数是为了更新词向量，使得模型能够更好地预测上下文词。所以，你说的"求偏导数的目的是完成梯度下降的优化"是完全正确的。

![image.png|1000](https://imagehosting4picgo.oss-cn-beijing.aliyuncs.com/imagehosting/fix-dir%2Fpicgo%2Fpicgo-clipboard-images%2F2024%2F09%2F20%2F11-42-21-5ec4c7c1cddba14c6e75ebc678ff7a9d-202409201142560-9bbf3b.png)

1. 想做回归，找了一个两个参数的直线
2. 目标是所有点与直线的 y 轴距离和最短，其实就是真实值和预测值的偏差越小，也就是**损失函数**
3. 求损失函数的时候的最小值时就需要用梯度下降算法  
![image.png|1000](https://imagehosting4picgo.oss-cn-beijing.aliyuncs.com/imagehosting/fix-dir%2Fpicgo%2Fpicgo-clipboard-images%2F2024%2F09%2F20%2F11-44-37-ccc37a8462a69c9bec124c80f03b6722-202409201144743-9db084.png)
